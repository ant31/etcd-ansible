# Test/Dev environment inventory for etcd cluster
#
# This is a working example for testing. Replace IPs with your test nodes.
# This uses the SAME playbooks as production - only the inventory differs.
#
# Usage:
#   Create:   make test-create     (or: ansible-playbook -i inventory-test.ini playbooks/etcd-cluster.yaml -e etcd_action=create -b)
#   Health:   make test-health     (or: ansible-playbook -i inventory-test.ini playbooks/etcd-health.yaml)
#   Upgrade:  make test-upgrade    (or: ansible-playbook -i inventory-test.ini playbooks/upgrade-cluster.yaml -b)
#   Delete:   make test-delete     (or: ansible-playbook -i inventory-test.ini playbooks/etcd-cluster.yaml -e etcd_delete_cluster=true -b)

# Etcd cluster nodes (odd number recommended: 3, 5, 7)
[etcd]
etcd-test-1 ansible_host=10.0.1.10 ip=10.0.1.10
etcd-test-2 ansible_host=10.0.1.11 ip=10.0.1.11
etcd-test-3 ansible_host=10.0.1.12 ip=10.0.1.12

# Optional: Nodes that need client certificates
[etcd-clients]
test-app-1 ansible_host=10.0.2.10 ip=10.0.2.10

# Cert-manager nodes (runs step-ca)
[etcd-cert-managers]
etcd-test-1  # Primary cert-manager
etcd-test-2  # Backup cert-manager (optional but recommended)

# Combined group (do not modify)
[etcd-all:children]
etcd
etcd-clients

# Global variables for test environment
[all:vars]
# SSH settings
ansible_user=root
ansible_python_interpreter=/usr/bin/python3

# Cluster configuration
etcd_cluster_name=test-cluster
etcd_version=v3.5.26

# Ports (default)
# etcd_ports.client=2379
# etcd_ports.peer=2380

# Backup configuration (use test bucket)
step_ca_backup_s3_bucket=etcd-test-backups
step_ca_backup_s3_prefix=step-ca-test
etcd_upload_backup.bucket=etcd-test-backups
etcd_upload_backup.prefix=test-cluster/

# Backup scheduling (enabled by default)
etcd_backup_cron_enabled=true
ca_backup_cron_enabled=true

# Encryption (configure in group_vars/all/vault.yml)
step_ca_backup_encryption_method=aws-kms
step_ca_backup_kms_key_id=alias/etcd-ca-backup-test

# Optional: Healthcheck monitoring
# backup_healthcheck_url=https://hc-ping.com/your-test-uuid
# ca_backup_healthcheck_url=https://hc-ping.com/your-test-ca-uuid
