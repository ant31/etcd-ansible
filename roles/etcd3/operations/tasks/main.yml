---
# Etcd cluster operations role
# Supports: status, members, logs, compact, defrag, health
# Usage: Set operation_action variable

- name: Show cluster status
  include_tasks: status.yml
  when: operation_action == 'status'
  tags:
    - status

- name: List cluster members
  include_tasks: members.yml
  when: operation_action == 'members'
  tags:
    - members

- name: View logs
  include_tasks: logs.yml
  when: operation_action == 'logs'
  tags:
    - logs

- name: Follow logs
  include_tasks: logs-follow.yml
  when: operation_action == 'logs-follow'
  tags:
    - logs

- name: Compact database
  include_tasks: compact.yml
  when: operation_action == 'compact'
  tags:
    - compact

- name: Defragment database
  include_tasks: defrag.yml
  when: operation_action == 'defrag'
  tags:
    - defrag

- name: Cluster health check
  include_tasks: health.yml
  when: operation_action == 'health'
  tags:
    - health

- name: Verify backup cron jobs
  include_tasks: verify-backup-cron.yml
  when: operation_action == 'verify-backup-cron'
  tags:
    - verify-backup-cron

- name: Certificate health check
  include_tasks: health-certs.yml
  when: operation_action == 'health-certs'
  tags:
    - health-certs

- name: step-ca health check
  include_tasks: health-stepca.yml
  when: operation_action == 'health-stepca'
  tags:
    - health-stepca

- name: Multi-cluster dashboard
  include_tasks: dashboard.yml
  when: operation_action == 'dashboard'
  tags:
    - dashboard
